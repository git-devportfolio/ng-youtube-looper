<div class="speed-control">
  <div class="speed-label">
    <span class="label-text">Vitesse</span>
    <span class="current-speed" [class.synchronized]="isSynchronized">
      {{ currentRate }}x
      @if (!isSynchronized) {
        <small class="sync-indicator" title="Non synchronisé avec le player YouTube">⚠️</small>
      }
    </span>
  </div>

  <!-- Preset Speed Buttons -->
  <div class="speed-presets">
    @for (preset of speedPresets; track preset.value) {
      <button
        type="button"
        class="speed-preset"
        [class.active]="currentRate === preset.value"
        [disabled]="disabled"
        (click)="setPresetSpeed(preset.value)"
        [title]="preset.label"
      >
        {{ preset.display }}
      </button>
    }
  </div>

  <!-- Speed Control Buttons -->
  <div class="speed-buttons">
    <button
      type="button"
      class="speed-button decrease"
      [disabled]="disabled || !canDecrease"
      (click)="decreasePlaybackSpeed()"
      title="Diminuer la vitesse (-0.25x)"
    >
      <span class="speed-icon">🐌</span>
      <span class="speed-text">-</span>
    </button>

    <button
      type="button"
      class="speed-button increase"
      [disabled]="disabled || !canIncrease"
      (click)="increasePlaybackSpeed()"
      title="Augmenter la vitesse (+0.25x)"
    >
      <span class="speed-icon">🐰</span>
      <span class="speed-text">+</span>
    </button>
  </div>

  <!-- Manual Input -->
  <div class="manual-input" *ngIf="showManualInput">
    <label class="input-label">Vitesse personnalisée (0.25x - 2x)</label>
    <div class="input-controls">
      <input
        type="number"
        [formControl]="manualSpeedControl"
        class="speed-input"
        placeholder="1.0"
        min="0.25"
        max="2"
        step="0.1"
        autocomplete="off"
        [disabled]="disabled"
      >
      <button
        type="button"
        class="apply-button"
        [disabled]="!manualSpeedControl.valid || disabled"
        (click)="applyManualSpeed()"
        title="Appliquer la vitesse personnalisée"
      >
        ✓
      </button>
    </div>
  </div>

  <!-- YouTube Integration Status -->
  @if (useDirectIntegration) {
    <div class="integration-status" title="Intégration directe avec YouTube">
      <span class="integration-icon">🔗</span>
      @if (isSynchronized) {
        <span class="status-text synchronized">Synchronisé</span>
      } @else {
        <span class="status-text not-synchronized">Désynchronisé</span>
      }
    </div>
  }

  <!-- Toggle Manual Input -->
  <button
    type="button"
    class="toggle-manual"
    [class.active]="showManualInput"
    (click)="toggleManualInput()"
    [disabled]="disabled"
    title="Saisie manuelle de vitesse"
  >
    {{ showManualInput ? '⌨️' : '⚙️' }}
  </button>
</div>