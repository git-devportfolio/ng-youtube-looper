<div class="speed-control">
  <div class="speed-label">
    <span class="label-text">Vitesse</span>
    <span class="current-speed" [class.synchronized]="isSynchronized">
      {{ currentRate }}x
      @if (!isSynchronized) {
        <small class="sync-indicator" title="Non synchronis√© avec le player YouTube">‚ö†Ô∏è</small>
      }
    </span>
  </div>

  <!-- Preset Speed Buttons -->
  <div class="speed-presets">
    @for (preset of speedPresets; track preset.value) {
      <button
        type="button"
        class="speed-preset"
        [class.active]="currentRate === preset.value"
        [disabled]="disabled"
        (click)="setPresetSpeed(preset.value)"
        [title]="preset.label"
      >
        {{ preset.display }}
      </button>
    }
  </div>

  <!-- Speed Control Buttons -->
  <div class="speed-buttons">
    <button
      type="button"
      class="speed-button decrease"
      [disabled]="disabled || !canDecrease"
      (click)="decreasePlaybackSpeed()"
      title="Diminuer la vitesse (-0.25x)"
    >
      <span class="speed-icon">üêå</span>
      <span class="speed-text">-</span>
    </button>

    <button
      type="button"
      class="speed-button increase"
      [disabled]="disabled || !canIncrease"
      (click)="increasePlaybackSpeed()"
      title="Augmenter la vitesse (+0.25x)"
    >
      <span class="speed-icon">üê∞</span>
      <span class="speed-text">+</span>
    </button>
  </div>

  <!-- Manual Input -->
  <div class="manual-input" *ngIf="showManualInput">
    <label class="input-label">Vitesse personnalis√©e ({{ validationService.MIN_PLAYBACK_SPEED }}x - {{ validationService.MAX_PLAYBACK_SPEED }}x par pas de {{ validationService.PLAYBACK_SPEED_STEP }}x)</label>
    <div class="input-controls">
      <input
        type="number"
        [formControl]="manualSpeedControl"
        class="speed-input"
        [class.error]="manualInputError"
        placeholder="1.0"
        [min]="validationService.MIN_PLAYBACK_SPEED"
        [max]="validationService.MAX_PLAYBACK_SPEED"
        [step]="validationService.PLAYBACK_SPEED_STEP"
        autocomplete="off"
        [disabled]="disabled"
      >
      <button
        type="button"
        class="apply-button"
        [disabled]="disabled || manualInputError !== null"
        (click)="applyManualSpeed()"
        title="Appliquer la vitesse personnalis√©e (arrondie automatiquement)"
      >
        ‚úì
      </button>
    </div>
    @if (manualInputError) {
      <div class="input-error">{{ manualInputError }}</div>
    }
  </div>

  <!-- YouTube Integration Status -->
  @if (useDirectIntegration) {
    <div class="integration-status" title="Int√©gration directe avec YouTube">
      <span class="integration-icon">üîó</span>
      @if (isSynchronized) {
        <span class="status-text synchronized">Synchronis√©</span>
      } @else {
        <span class="status-text not-synchronized">D√©synchronis√©</span>
      }
    </div>
  }

  <!-- Toggle Manual Input -->
  <button
    type="button"
    class="toggle-manual"
    [class.active]="showManualInput"
    (click)="toggleManualInput()"
    [disabled]="disabled"
    title="Saisie manuelle de vitesse"
  >
    {{ showManualInput ? '‚å®Ô∏è' : '‚öôÔ∏è' }}
  </button>
</div>