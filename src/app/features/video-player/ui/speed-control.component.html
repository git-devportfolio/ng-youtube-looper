<div class="speed-control">
  <div class="speed-label">
    <span class="label-text">Vitesse</span>
    <span class="current-speed">{{ currentRate }}x</span>
  </div>

  <!-- Preset Speed Buttons -->
  <div class="speed-presets">
    @for (preset of speedPresets; track preset.value) {
      <button
        type="button"
        class="speed-preset"
        [class.active]="currentRate === preset.value"
        [disabled]="disabled"
        (click)="setPresetSpeed(preset.value)"
        [title]="preset.label"
      >
        {{ preset.display }}
      </button>
    }
  </div>

  <!-- Speed Control Buttons -->
  <div class="speed-buttons">
    <button
      type="button"
      class="speed-button decrease"
      [disabled]="disabled || !canDecrease"
      (click)="decreaseSpeed.emit()"
      title="Diminuer la vitesse"
    >
      <span class="speed-icon">🐌</span>
      <span class="speed-text">-</span>
    </button>

    <button
      type="button"
      class="speed-button increase"
      [disabled]="disabled || !canIncrease"
      (click)="increaseSpeed.emit()"
      title="Augmenter la vitesse"
    >
      <span class="speed-icon">🐰</span>
      <span class="speed-text">+</span>
    </button>
  </div>

  <!-- Manual Input -->
  <div class="manual-input" *ngIf="showManualInput">
    <input
      type="number"
      [formControl]="manualSpeedControl"
      class="speed-input"
      placeholder="1.0"
      min="0.25"
      max="2"
      step="0.1"
      [disabled]="disabled"
    >
    <button
      type="button"
      class="apply-button"
      [disabled]="!manualSpeedControl.valid || disabled"
      (click)="applyManualSpeed()"
      title="Appliquer la vitesse personnalisée"
    >
      ✓
    </button>
  </div>

  <!-- Toggle Manual Input -->
  <button
    type="button"
    class="toggle-manual"
    (click)="toggleManualInput()"
    [disabled]="disabled"
    title="Saisie manuelle de vitesse"
  >
    {{ showManualInput ? '⌨️' : '⚙️' }}
  </button>
</div>